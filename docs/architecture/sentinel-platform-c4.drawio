<mxfile host="app.diagrams.net" modified="2026-01-27T00:00:00.000Z" agent="ChatGPT" version="20.8.16" type="device" compressed="false">
  <diagram id="c4-context" name="C4 - Context">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="t1" value="Sentinel Platform — C4 Context" style="text;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="1560" height="40" as="geometry"/>
        </mxCell>

        <!-- System Boundary -->
        <mxCell id="b1" value="Sentinel Platform (System)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="460" y="160" width="680" height="420" as="geometry"/>
        </mxCell>

        <!-- Inside system note -->
        <mxCell id="snote" value="Plataforma para cotação, underwriting, emissão de apólice, cobrança e auditoria&#10;(Open Insurance / Banking-ready)" style="text;html=1;align=center;verticalAlign=middle;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="510" y="270" width="580" height="120" as="geometry"/>
        </mxCell>

        <!-- Actors -->
        <mxCell id="a1" value="Cliente&#10;(App Banco/Seguradora)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="230" width="280" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="a2" value="Corretor/Parceiro" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="360" width="280" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="a3" value="Operações / Compliance" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="490" width="280" height="90" as="geometry"/>
        </mxCell>

        <!-- External Systems -->
        <mxCell id="e1" value="Open Finance /&#10;Open Insurance APIs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1220" y="230" width="300" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="e2" value="Payment Provider&#10;(PIX/Boleto/Cartão)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1220" y="360" width="300" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="e3" value="Notificações&#10;(Email/SMS/Push)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1220" y="490" width="300" height="90" as="geometry"/>
        </mxCell>

        <!-- Relationships -->
        <mxCell id="r1" value="Cota, contrata, consulta apólice" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="a1" target="b1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="r2" value="Origina cotações / acompanha propostas" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="a2" target="b1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="r3" value="Revisão manual, auditoria, investigação" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="a3" target="b1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="r4" value="Coleta de dados (com consentimento)" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="b1" target="e1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="r5" value="Cobrança / confirmação / conciliação" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="b1" target="e2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="r6" value="Envio de notificações" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="b1" target="e3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <diagram id="c4-containers" name="C4 - Containers">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="t2" value="Sentinel Platform — C4 Containers" style="text;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="1560" height="40" as="geometry"/>
        </mxCell>

        <!-- Kubernetes Boundary -->
        <mxCell id="k8s" value="Kubernetes Cluster (Cloud)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="40" y="90" width="1120" height="760" as="geometry"/>
        </mxCell>

        <!-- External Boundary -->
        <mxCell id="ext" value="External Systems" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1180" y="90" width="380" height="760" as="geometry"/>
        </mxCell>

        <!-- Ingress/API Gateway -->
        <mxCell id="gw" value="API Gateway / Ingress&#10;(Rate limit, AuthN/Z, Routing)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="80" y="130" width="320" height="80" as="geometry"/>
        </mxCell>

        <!-- Services row 1 -->
        <mxCell id="idn" value="identity-service&#10;(OIDC/JWT, RBAC)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="80" y="250" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="q" value="quote-service&#10;(Quote/Offer, Versioning)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="360" y="250" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="rk" value="risk-service&#10;(Underwriting, Score, Rules)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="640" y="250" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="pl" value="policy-service&#10;(Issue Policy, Lifecycle)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="920" y="250" width="220" height="90" as="geometry"/>
        </mxCell>

        <!-- Services row 2 -->
        <mxCell id="bl" value="billing-service&#10;(Invoice, Payment, Reconciliation)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="360" y="370" width="260" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="au" value="audit-service&#10;(Append-only audit log, Queries)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="640" y="370" width="260" height="90" as="geometry"/>
        </mxCell>

        <!-- Kafka -->
        <mxCell id="kf" value="Kafka&#10;(Domain Events + Outbox Consumers)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="80" y="510" width="1060" height="80" as="geometry"/>
        </mxCell>

        <!-- Databases -->
        <mxCell id="db1" value="PostgreSQL — identity" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="80" y="620" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="db2" value="PostgreSQL — quote" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="300" y="620" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="db3" value="PostgreSQL — risk" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="520" y="620" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="db4" value="PostgreSQL — policy" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="740" y="620" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="db5" value="PostgreSQL — billing" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="960" y="620" width="180" height="60" as="geometry"/>
        </mxCell>

        <!-- Observability -->
        <mxCell id="obs" value="Observability" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="80" y="710" width="1060" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="otel" value="OpenTelemetry Collector" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="100" y="750" width="240" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="prom" value="Prometheus" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="360" y="750" width="180" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="graf" value="Grafana" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="560" y="750" width="160" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="trc" value="Tempo/Jaeger" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="740" y="750" width="180" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="loki" value="Loki (logs)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="940" y="750" width="180" height="50" as="geometry"/>
        </mxCell>

        <!-- External systems -->
        <mxCell id="opn" value="Open Finance / Open Insurance APIs" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1200" y="160" width="340" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="pay" value="Payment Provider (PIX/Boleto/Cartão)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1200" y="260" width="340" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="not" value="Notifications (Email/SMS/Push)" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1200" y="360" width="340" height="80" as="geometry"/>
        </mxCell>

        <!-- Edges: Gateway to services -->
        <mxCell id="e-gw-q" value="REST/JSON" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gw" target="q">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-gw-idn" value="Auth" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gw" target="idn">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-gw-pl" value="REST/JSON" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gw" target="pl">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-gw-bl" value="REST/JSON" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gw" target="bl">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Events via Kafka -->
        <mxCell id="e-q-kf" value="Publish domain events (Outbox)" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="q" target="kf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-rk-kf" value="Publish domain events (Outbox)" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="rk" target="kf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-pl-kf" value="Publish domain events (Outbox)" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="pl" target="kf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-bl-kf" value="Publish domain events (Outbox)" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="bl" target="kf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e-kf-rk" value="Consume quote/offer events" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="kf" target="rk">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-kf-pl" value="Consume risk decisions" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="kf" target="pl">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-kf-bl" value="Consume policy issued" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="kf" target="bl">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-kf-au" value="Consume ALL events" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="kf" target="au">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- DB connections -->
        <mxCell id="e-idn-db1" value="JPA" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="idn" target="db1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-q-db2" value="JPA" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="q" target="db2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-rk-db3" value="JPA" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="rk" target="db3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-pl-db4" value="JPA" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="pl" target="db4">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-bl-db5" value="JPA" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="bl" target="db5">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- External integrations -->
        <mxCell id="e-q-opn" value="Data enrichment (consent)" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="q" target="opn">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-bl-pay" value="Charge / confirm / webhook" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="bl" target="pay">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-gw-not" value="Notify customer" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gw" target="not">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Observability edges -->
        <mxCell id="e-svc-otel" value="Traces/Metrics/Logs" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="q" target="otel">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-otel-trc" value="Export traces" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="otel" target="trc">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-otel-prom" value="Export metrics" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="otel" target="prom">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-prom-graf" value="Dashboards" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="prom" target="graf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-trc-graf" value="Trace UI" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="trc" target="graf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-loki-graf" value="Logs UI" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="loki" target="graf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
